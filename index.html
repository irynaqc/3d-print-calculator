<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>3D –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥—Ä—É–∫—É ‚Ä¢ Bambu A1 Mini</title>

  <!-- ‚úÖ PWA: —â–æ–± –±—É–ª–æ —è–∫ ‚Äú–¥–æ–¥–∞—Ç–æ–∫‚Äù -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#22c55e">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="icon" href="icon-192.png">

  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --line:#d1d5db;
      --accent:#22c55e;
      --accentDark:#14532d;
      --greenBg:#eafff0;
      --greenLine:#86efac;
      --purpleBg:#eeecff;
      --purpleLine:#c4b5fd;
      --shadow:0 10px 35px rgba(0,0,0,.06);
      --r:18px;
    }

    *{box-sizing:border-box}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:var(--bg);
      margin:0;
      color:var(--text);
      padding:20px;
    }

    h1{margin:0 0 6px;font-size:34px;line-height:1.1}
    small{color:var(--muted);font-weight:600}

    .wrapper{
      max-width:1200px;
      margin:16px auto 0;
      display:grid;
      grid-template-columns:2fr 1fr;
      gap:20px;
      align-items:start;
    }

    .card{
      background:var(--card);
      border-radius:var(--r);
      padding:18px;
      box-shadow:var(--shadow);
      margin-bottom:18px;
    }

    h2{
      font-size:18px;
      margin:0 0 14px;
      display:flex;
      align-items:center;
      gap:10px;
    }

    .tabs{display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap}
    .tab{
      padding:10px 16px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      cursor:pointer;
      font-weight:900;
      user-select:none;
    }
    .tab.active{
      background:var(--accent);
      border-color:var(--accent);
      color:#fff;
    }

    .form{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:14px;
    }
    .form.two{grid-template-columns:repeat(2,1fr)}
    @media(max-width:900px){
      .wrapper{grid-template-columns:1fr}
      .form{grid-template-columns:1fr}
      .form.two{grid-template-columns:1fr}
    }

    label{
      font-size:13px;
      color:var(--muted);
      display:flex;
      flex-direction:column;
      gap:6px;
      font-weight:700;
    }

    input{
      padding:12px;
      border-radius:14px;
      border:1px solid var(--line);
      font-size:18px;
      outline:none;
      background:#fff;
    }
    input:focus{
      border-color:#a7f3d0;
      box-shadow:0 0 0 4px rgba(34,197,94,.15);
    }

    .summary{position:sticky;top:20px}
    @media(max-width:900px){.summary{position:static}}

    .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin:12px 0;
      font-size:18px;
      gap:10px;
    }
    .row b{font-weight:950;white-space:nowrap}

    .totalBox{
      background:var(--greenBg);
      border:1px solid var(--greenLine);
      border-radius:var(--r);
      padding:18px;
      margin:16px 0;
    }
    .totalBox .t{font-size:22px;margin-bottom:8px;font-weight:900}
    .totalBox .v{font-size:40px;font-weight:1000;color:var(--accentDark)}

    .price{
      border-radius:var(--r);
      padding:16px;
      margin:14px 0;
      border:1px solid transparent;
    }
    .green{background:var(--greenBg);border-color:var(--greenLine)}
    .purple{background:var(--purpleBg);border-color:var(--purpleLine)}
    .price .cap{font-size:20px;font-weight:1000;margin-bottom:6px}
    .price .val{font-size:22px;font-weight:900}

    button{
      width:100%;
      padding:18px;
      border:none;
      border-radius:var(--r);
      background:var(--accent);
      color:#fff;
      font-size:22px;
      font-weight:1000;
      cursor:pointer;
    }
    button:active{transform:scale(.99)}
    #status{
      margin:10px 0;
      color:var(--muted);
      font-weight:800;
      line-height:1.25;
      font-size:14px;
    }

    /* ‚úÖ –ú–û–ë–Ü–õ–¨–ù–ò–ô –í–ò–ì–õ–Ø–î ‚Äú–Ø–ö –î–û–î–ê–¢–û–ö‚Äù */
    @media (max-width: 600px) {
      body{padding:12px}
      h1{font-size:26px}
      small{font-size:13px}
      .card{padding:16px;border-radius:16px}
      label{font-size:14px}
      input{font-size:20px;padding:14px;border-radius:16px}
      .tab{padding:12px 16px;font-size:16px}
      .row{font-size:18px}
      .totalBox .v{font-size:34px}
      button{font-size:22px;padding:18px;border-radius:16px}
      #status{font-size:13px}
    }
  </style>
</head>

<body>
  <h1>üí∞ 3D –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥—Ä—É–∫—É</h1>
  <small>Bambu A1 Mini ‚Ä¢ PLA / PETG ‚Ä¢ –≥—Ä–Ω ‚Ä¢ –ø–æ–¥–∞—Ç–∫–∏ –§–û–ü</small>

  <div class="wrapper">
    <div>
      <div class="card">
        <h2>‚öôÔ∏è –ë–∞–∑–æ–≤—ñ –≤–∏—Ç—Ä–∞—Ç–∏</h2>

        <div class="tabs">
          <div class="tab active" data-mat="PLA" data-w="130">PLA (130W)</div>
          <div class="tab" data-mat="PETG" data-w="170">PETG (170W)</div>
        </div>

        <div class="form">
          <label>–¶—ñ–Ω–∞ –∫–æ—Ç—É—à–∫–∏ (–≥—Ä–Ω)
            <input id="spoolPrice" type="number" step="0.01" value="500">
          </label>
          <label>–í–∞–≥–∞ –∫–æ—Ç—É—à–∫–∏ (–≥)
            <input id="spoolWeight" type="number" step="1" value="1000">
          </label>
          <label>–¢–∞—Ä–∏—Ñ —Å–≤—ñ—Ç–ª–∞ (–≥—Ä–Ω/–∫–í—Ç¬∑–≥–æ–¥)
            <input id="kwh" type="number" step="0.01" value="4.32">
          </label>
          <label>–ê–º–æ—Ä—Ç–∏–∑–∞—Ü—ñ—è (–≥—Ä–Ω/–≥–æ–¥)
            <input id="amort" type="number" step="0.01" value="10">
          </label>
          <label>–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è (–í—Ç)
            <input id="power" type="number" step="1" value="130">
          </label>
          <label>–§—ñ–ª–∞–º–µ–Ω—Ç —É –∑–≤—ñ—Ç—ñ
            <input id="material" type="text" value="PLA">
          </label>
        </div>
      </div>

      <div class="card">
        <h2>üîß –°–µ—Ä–≤—ñ—Å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h2>
        <div class="form two">
          <label>–¶—ñ–Ω–∞ –∑–∞ –∑–∞–ø—É—Å–∫ (–≥—Ä–Ω)
            <input id="setup" type="number" step="0.01" value="50">
          </label>
          <label>–ú—ñ–Ω. —Ü—ñ–Ω–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–≥—Ä–Ω)
            <input id="minOrder" type="number" step="0.01" value="150">
          </label>
        </div>

        <div style="height:14px"></div>

        <h2 style="margin-top:0">üßæ –ü–æ–¥–∞—Ç–∫–∏ –§–û–ü</h2>
        <div class="form two">
          <label>–ü–æ–¥–∞—Ç–∫–∏/–º—ñ—Å—è—Ü—å (–≥—Ä–Ω)
            <input id="taxMonthly" type="number" step="0.01" value="5000">
          </label>
          <label>–ó–∞–º–æ–≤–ª–µ–Ω—å/–º—ñ—Å—è—Ü—å (—à—Ç)
            <input id="ordersMonthly" type="number" step="1" value="30">
          </label>
        </div>
      </div>

      <div class="card">
        <h2>üì¶ –î–∞–Ω—ñ –ø—Ä–æ –º–æ–¥–µ–ª—å</h2>
        <div class="form">
          <label>–ù–∞–∑–≤–∞ –¥–µ—Ç–∞–ª—ñ/–∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
            <input id="name" type="text" value="–ö–æ—Ä–æ–±–∫–∞ + –∫—Ä–∏—à–∫–∞">
          </label>
          <label>–î–æ–¥–∞—Ç–∫–æ–≤—ñ –≤–∏—Ç—Ä–∞—Ç–∏ (–≥—Ä–Ω/—à—Ç)
            <input id="extra" type="number" step="0.01" value="0">
          </label>
          <label>–í–∞–≥–∞ 1 —à—Ç (–≥)
            <input id="weight" type="number" step="0.01" value="0">
          </label>
          <label>–ö—ñ–ª—å–∫—ñ—Å—Ç—å (—à—Ç)
            <input id="qty" type="number" step="1" value="1">
          </label>
          <label>–ß–∞—Å 1 —à—Ç (–≥–æ–¥)
            <input id="hours" type="number" step="0.01" value="0">
          </label>
          <label>–•–≤
            <input id="mins" type="number" step="1" value="0">
          </label>
        </div>
      </div>
    </div>

    <div class="summary card">
      <h2>–ö–æ—à—Ç–æ—Ä–∏—Å –ø–∞—Ä—Ç—ñ—ó</h2>

      <div class="row"><span>–ü–ª–∞—Å—Ç–∏–∫:</span><b id="cPlastic">0.00 –≥—Ä–Ω</b></div>
      <div class="row"><span>–ï–Ω–µ—Ä–≥—ñ—è + –∑–Ω–æ—Å:</span><b id="cEnergy">0.00 –≥—Ä–Ω</b></div>
      <div class="row"><span>–ó–∞–ø—É—Å–∫:</span><b id="cSetup">50.00 –≥—Ä–Ω</b></div>
      <div class="row"><span>–î–æ–¥–∞—Ç–∫–æ–≤–æ:</span><b id="cExtra">0.00 –≥—Ä–Ω</b></div>

      <div class="totalBox">
        <div class="t">–°–æ–±—ñ–≤–∞—Ä—Ç—ñ—Å—Ç—å:</div>
        <div class="v" id="total">50.00 –≥—Ä–Ω</div>
      </div>

      <div class="price green">
        <div class="cap">–¶–Ü–ù–ê (√ó2 + —Ñ—ñ–∫—Å + –ø–æ–¥–∞—Ç–∫–∏)</div>
        <div class="val" id="p2">150 –≥—Ä–Ω</div>
      </div>

      <div class="price purple">
        <div class="cap">–°–ö–õ–ê–î–ù–ï (√ó3 + —Ñ—ñ–∫—Å + –ø–æ–¥–∞—Ç–∫–∏)</div>
        <div class="val" id="p3">150 –≥—Ä–Ω</div>
      </div>

      <div id="status">–°—Ç–∞—Ç—É—Å: —Å–∫—Ä–∏–ø—Ç —â–µ –Ω–µ —Ä–∞—Ö—É–≤–∞–≤‚Ä¶</div>
      <button id="recalcBtn">üîÑ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
    </div>
  </div>

<script>
(() => {
  const $ = (id) => document.getElementById(id);
  const num = (id) => {
    const el = $(id);
    if (!el) return 0;
    const v = parseFloat(el.value);
    return Number.isFinite(v) ? v : 0;
  };
  const set = (id, txt) => { const el = $(id); if (el) el.innerText = txt; };

  function calc(){
    const spoolPrice  = num('spoolPrice');
    const spoolWeight = Math.max(1, num('spoolWeight'));
    const qty         = Math.max(1, Math.round(num('qty')));
    const weight1     = num('weight');

    const timePer1 = Math.max(0, num('hours') + num('mins')/60);
    const totalTime = timePer1 * qty;

    const powerW = num('power');
    const kwhRate = num('kwh');
    const amortPerHour = num('amort');

    const setup = num('setup');
    const extra = num('extra') * qty;
    const minOrder = num('minOrder');

    // –ü–æ–¥–∞—Ç–∫–∏/–∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
    const taxMonthly = num('taxMonthly');
    const ordersMonthly = Math.max(1, Math.round(num('ordersMonthly')));
    const taxPerOrder = taxMonthly / ordersMonthly;

    // –°–æ–±—ñ–≤–∞—Ä—Ç—ñ—Å—Ç—å
    const plastic = (spoolPrice / spoolWeight) * (weight1 * qty);
    const energyPlusAmort = ((powerW/1000) * totalTime * kwhRate) + (totalTime * amortPerHour);
    const total = plastic + energyPlusAmort + setup + extra;

    // –¶—ñ–Ω–∏ –ø—Ä–æ–¥–∞–∂—É
    const p2 = Math.max(minOrder, (total * 2) + taxPerOrder);
    const p3 = Math.max(minOrder, (total * 3) + taxPerOrder);

    set('cPlastic', plastic.toFixed(2) + ' –≥—Ä–Ω');
    set('cEnergy', energyPlusAmort.toFixed(2) + ' –≥—Ä–Ω');
    set('cSetup', setup.toFixed(2) + ' –≥—Ä–Ω');
    set('cExtra', extra.toFixed(2) + ' –≥—Ä–Ω');

    set('total', total.toFixed(2) + ' –≥—Ä–Ω');
    set('p2', Math.ceil(p2) + ' –≥—Ä–Ω');
    set('p3', Math.ceil(p3) + ' –≥—Ä–Ω');

    const now = new Date();
    set('status',
      '–û–Ω–æ–≤–ª–µ–Ω–æ: ' + now.toLocaleTimeString() +
      ' ‚Ä¢ –ü–æ–¥–∞—Ç–æ–∫/–∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚âà ' + taxPerOrder.toFixed(0) + ' –≥—Ä–Ω'
    );
  }

  // –ü–µ—Ä–µ–º–∏–∫–∞—á PLA/PETG
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      $('material').value = tab.dataset.mat;
      $('power').value = tab.dataset.w;
      calc();
    });
  });

  // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–∫—É
  $('recalcBtn').addEventListener('click', () => {
    $('recalcBtn').textContent = '‚úÖ –ü–µ—Ä–µ—Ä–∞—Ö–æ–≤–∞–Ω–æ';
    calc();
    setTimeout(()=> $('recalcBtn').textContent = 'üîÑ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏', 700);
  });

  // –ê–≤—Ç–æ-–ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –ø—Ä–∏ –∑–º—ñ–Ω—ñ –ø–æ–ª—ñ–≤
  [
    'spoolPrice','spoolWeight','kwh','amort','power','setup','minOrder',
    'taxMonthly','ordersMonthly',
    'extra','weight','qty','hours','mins'
  ].forEach(id => {
    const el = $(id);
    if (el) { el.addEventListener('input', calc); el.addEventListener('change', calc); }
  });

  calc();
})();
</script>
</body>
</html>
